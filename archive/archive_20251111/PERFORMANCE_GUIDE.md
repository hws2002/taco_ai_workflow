# ì„±ëŠ¥ ì¸¡ì • ë° ìµœì í™” ê°€ì´ë“œ

ê° ìŠ¤í…ë³„ ì‹¤í–‰ ì‹œê°„ì„ ì¸¡ì •í•˜ì—¬ ë³‘ëª© ì§€ì ì„ íŒŒì•…í•˜ê³  ìµœì í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“Š ì‹¤í–‰ ì‹œê°„ ì¸¡ì •

í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ê° ìŠ¤í…ë³„ë¡œ ì†Œìš” ì‹œê°„ì´ ìë™ìœ¼ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤.

### ì‹¤í–‰ ì˜ˆì‹œ

```bash
python -X utf8 test/test_embedding_workflow.py --use-cache
```

### ì¶œë ¥ ì˜ˆì‹œ

```
================================================================================
AI ë‹µë³€ ê¸°ë°˜ ë¬¸ì„œ ì„ë² ë”© ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸
================================================================================

[STEP 1] ë°ì´í„° ë¡œë”©
--------------------------------------------------------------------------------
ìƒ˜í”Œ 50ê°œ ëŒ€í™” ë¡œë”© ì¤‘...
ë°ì´í„° ë¡œë“œ ì¤‘: C:\Users\hwoos\Desktop\taco\data\conversations.json
ì´ 376ê°œì˜ ëŒ€í™”ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.
â±ï¸  ì†Œìš” ì‹œê°„: 1.2ì´ˆ

[STEP 2] AI ë‹µë³€ë§Œ ì¶”ì¶œ
--------------------------------------------------------------------------------
ì´ 820ê°œì˜ AI ë‹µë³€ì„ ì¶”ì¶œí–ˆìŠµë‹ˆë‹¤.
âœ“ ì´ 820ê°œì˜ AI ë‹µë³€ ì¶”ì¶œ ì™„ë£Œ
â±ï¸  ì†Œìš” ì‹œê°„: 450ms

[STEP 3] ì„ë² ë”© ë²¡í„° ìƒì„±
--------------------------------------------------------------------------------
âœ“ SBERT ëª¨ë¸ ë¡œë”© ì™„ë£Œ
âœ“ í•œêµ­ì–´ ë¶ˆìš©ì–´ 145ê°œ ë¡œë“œ
âœ“ KeyBERT ì´ˆê¸°í™” ì™„ë£Œ

ì´ 820ê°œì˜ AI ë‹µë³€ ë¶„ì„ ì¤‘...
âœ“ ì´ 820ê°œì˜ ì„ë² ë”© ìƒì„± ì™„ë£Œ
â±ï¸  ì†Œìš” ì‹œê°„: 3ë¶„ 25.3ì´ˆ
  ì„ë² ë”© ì°¨ì›: 1024

[STEP 4] BERTopic í´ëŸ¬ìŠ¤í„°ë§
--------------------------------------------------------------------------------
BERTopicì„ ì‚¬ìš©í•œ AI ë‹µë³€ í´ëŸ¬ìŠ¤í„°ë§
âœ“ í´ëŸ¬ìŠ¤í„°ë§ ì™„ë£Œ!
  ìƒì„±ëœ í† í”½ ìˆ˜: 15
â±ï¸  ì†Œìš” ì‹œê°„: 1ë¶„ 12.8ì´ˆ
  ìƒì„±ëœ í† í”½ ìˆ˜: 15

[STEP 5] ëŒ€í™”ë³„ í† í”½ í’€ë§
--------------------------------------------------------------------------------
âœ“ 50ê°œì˜ ëŒ€í™”ì— ëŒ€í•œ ì£¼ì œ ë²¡í„° ìƒì„± ì™„ë£Œ
â±ï¸  ì†Œìš” ì‹œê°„: 2.1ì´ˆ

[STEP 6] ë¬¸ì„œ ê°„ ìœ ì‚¬ë„ ê³„ì‚°
--------------------------------------------------------------------------------
ëª¨ë“  ë¬¸ì„œ ìŒ ê°„ì˜ ìœ ì‚¬ë„ ê³„ì‚° ì¤‘...
ì´ 1225ê°œì˜ ìŒ ê³„ì‚° ì˜ˆì •
âœ“ ìœ ì‚¬ë„ ê³„ì‚° ì™„ë£Œ: 1225ê°œì˜ ìŒ
â±ï¸  ì†Œìš” ì‹œê°„: 3.7ì´ˆ

================================================================================
ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
================================================================================

ğŸ“Š ë°ì´í„° ìš”ì•½:
  - ëŒ€í™” ìˆ˜: 50
  - AI ë‹µë³€ ìˆ˜: 820
  - ìƒì„±ëœ í† í”½ ìˆ˜: 15
  - ë¬¸ì„œë³„ í‰ê·  ì£¼ì œ ìˆ˜: 3.2
  - ìœ ì‚¬ë„ ìŒ ìˆ˜: 1225

â±ï¸  ì‹¤í–‰ ì‹œê°„ ìƒì„¸:
--------------------------------------------------------------------------------
  ë°ì´í„° ë¡œë”©               :      1.2ì´ˆ  (  0.4%)
  AI ë‹µë³€ ì¶”ì¶œ             :     450ms  (  0.1%)
  ì„ë² ë”© ìƒì„±              :   3ë¶„ 25.3ì´ˆ  ( 69.2%)
  BERTopic í´ëŸ¬ìŠ¤í„°ë§      :   1ë¶„ 12.8ì´ˆ  ( 24.6%)
  ë¬¸ì„œë³„ í’€ë§              :      2.1ì´ˆ  (  0.7%)
  ìœ ì‚¬ë„ ê³„ì‚°              :      3.7ì´ˆ  (  1.2%)
--------------------------------------------------------------------------------
  ì „ì²´ ì‹œê°„                :   4ë¶„ 57.2ì´ˆ  (100.0%)
================================================================================
```

## ğŸ“ˆ ì„±ëŠ¥ ë¶„ì„

### ë³‘ëª© êµ¬ê°„

ìœ„ ì˜ˆì‹œì—ì„œ ê°€ì¥ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ë‹¨ê³„:

1. **ì„ë² ë”© ìƒì„±** (69.2%) - 3ë¶„ 25ì´ˆ
   - SBERT ëª¨ë¸ë¡œ 820ê°œ AI ë‹µë³€ì„ 1024ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜
   - GPUê°€ ìˆìœ¼ë©´ ë” ë¹ ë¦„

2. **BERTopic í´ëŸ¬ìŠ¤í„°ë§** (24.6%) - 1ë¶„ 13ì´ˆ
   - UMAP ì°¨ì› ì¶•ì†Œ + HDBSCAN/K-Means í´ëŸ¬ìŠ¤í„°ë§
   - ë¬¸ì„œ ìˆ˜ì— ë”°ë¼ ì‹œê°„ ì¦ê°€

3. **ê¸°íƒ€ ë‹¨ê³„** (6.2%) - ì•½ 7ì´ˆ
   - ë¹„êµì  ë¹ ë¥´ê²Œ ì²˜ë¦¬ë¨

### ìºì‹œ ì‚¬ìš© ì‹œ ì„±ëŠ¥

```bash
# ì²« ì‹¤í–‰ (ìºì‹œ ìƒì„±)
python -X utf8 test/test_embedding_workflow.py --use-cache
# ì‹¤í–‰ ì‹œê°„: ì•½ 5ë¶„

# ë‘ ë²ˆì§¸ ì‹¤í–‰ (ìºì‹œ ì¬ì‚¬ìš©)
python -X utf8 test/test_embedding_workflow.py --use-cache
# ì‹¤í–‰ ì‹œê°„: ì•½ 10ì´ˆ (30ë°° ë¹ ë¦„!)
```

ìºì‹œ ì¬ì‚¬ìš© ì‹œ:
```
â±ï¸  ì‹¤í–‰ ì‹œê°„ ìƒì„¸:
--------------------------------------------------------------------------------
  ë°ì´í„° ë¡œë”©               :      1.2ì´ˆ  ( 12.0%)
  AI ë‹µë³€ ì¶”ì¶œ             :     450ms  (  4.5%)
  ì„ë² ë”© ìƒì„±              :      3.2ì´ˆ  ( 32.0%)  â† ìºì‹œì—ì„œ ë¡œë“œ
  BERTopic í´ëŸ¬ìŠ¤í„°ë§      :      2.8ì´ˆ  ( 28.0%)  â† ìºì‹œì—ì„œ ë¡œë“œ
  ë¬¸ì„œë³„ í’€ë§              :      1.1ì´ˆ  ( 11.0%)  â† ìºì‹œì—ì„œ ë¡œë“œ
  ìœ ì‚¬ë„ ê³„ì‚°              :      1.2ì´ˆ  ( 12.0%)  â† ìºì‹œì—ì„œ ë¡œë“œ
--------------------------------------------------------------------------------
  ì „ì²´ ì‹œê°„                :     10.0ì´ˆ  (100.0%)
================================================================================
```

## ğŸš€ ìµœì í™” íŒ

### 1. GPU ì‚¬ìš©
```python
# semantic_analyzer.pyì—ì„œ
# GPUê°€ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ì‚¬ìš©ë¨
# ì„ë² ë”© ìƒì„± ì†ë„ 3~5ë°° í–¥ìƒ
```

### 2. ë°°ì¹˜ í¬ê¸° ì¡°ì •
```python
# semantic_analyzer.pyì˜ create_embeddings_batch ë©”ì„œë“œ
embeddings = self.model.encode(
    processed_texts,
    batch_size=32,  # GPU ë©”ëª¨ë¦¬ì— ë”°ë¼ ì¡°ì • (32, 64, 128)
    show_progress_bar=True
)
```

### 3. ìƒ˜í”Œ í¬ê¸° ì¡°ì •
```bash
# ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
python -X utf8 test/test_embedding_workflow.py --sample-size 10

# ì¤‘ê°„ í…ŒìŠ¤íŠ¸
python -X utf8 test/test_embedding_workflow.py --sample-size 50

# ì „ì²´ ë°ì´í„°
python -X utf8 test/test_embedding_workflow.py --sample-size 376
```

### 4. BERTopic íŒŒë¼ë¯¸í„° íŠœë‹
```python
# embedding_processor.py
processor = EmbeddingProcessor(
    min_topic_size=5,      # ì‘ì„ìˆ˜ë¡ ë” ë§ì€ í† í”½ ìƒì„± (ëŠë¦¼)
    nr_topics=10,          # í† í”½ ê°œìˆ˜ ê³ ì • (ë¹ ë¦„)
    use_kmeans=True        # K-Means ì‚¬ìš© (HDBSCANë³´ë‹¤ ë¹ ë¦„)
)
```

## ğŸ“Š ì˜ˆìƒ ì‹¤í–‰ ì‹œê°„

| ë°ì´í„° í¬ê¸° | ìºì‹œ ì—†ìŒ | ìºì‹œ ìˆìŒ | ë¹„ìœ¨ |
|------------|----------|----------|------|
| 10ê°œ ëŒ€í™” (~160ê°œ ë‹µë³€) | 1ë¶„ 30ì´ˆ | 3ì´ˆ | 30ë°° |
| 50ê°œ ëŒ€í™” (~820ê°œ ë‹µë³€) | 5ë¶„ | 10ì´ˆ | 30ë°° |
| 100ê°œ ëŒ€í™” (~1640ê°œ ë‹µë³€) | 10ë¶„ | 20ì´ˆ | 30ë°° |
| ì „ì²´ (376ê°œ ëŒ€í™”) | 35ë¶„ | 1ë¶„ | 35ë°° |

*ì°¸ê³ : CPU ì„±ëŠ¥, GPU ìœ ë¬´ì— ë”°ë¼ ì°¨ì´ ìˆìŒ*

## ğŸ” ë³‘ëª© êµ¬ê°„ë³„ í•´ê²° ë°©ë²•

### ì„ë² ë”© ìƒì„±ì´ ë„ˆë¬´ ëŠë¦´ ë•Œ
```python
# 1. GPU ì‚¬ìš© (ìë™)
# 2. ë” ì‘ì€ ëª¨ë¸ ì‚¬ìš©
analyzer = SemanticAnalyzer(
    model_name="sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2",
    # bge-m3 ëŒ€ì‹  ë” ì‘ì€ ëª¨ë¸ (768ì°¨ì› -> 384ì°¨ì›)
)

# 3. ë°°ì¹˜ í¬ê¸° ì¦ê°€ (GPU ë©”ëª¨ë¦¬ ì¶©ë¶„í•˜ë©´)
# semantic_analyzer.pyì—ì„œ batch_size=64 ë˜ëŠ” 128
```

### í´ëŸ¬ìŠ¤í„°ë§ì´ ë„ˆë¬´ ëŠë¦´ ë•Œ
```python
# 1. K-Means ì‚¬ìš© (HDBSCANë³´ë‹¤ ë¹ ë¦„)
processor = EmbeddingProcessor(
    use_kmeans=True,
    n_clusters=10  # í† í”½ ê°œìˆ˜ ê³ ì •
)

# 2. í† í”½ ê°œìˆ˜ ì œí•œ
processor = EmbeddingProcessor(
    nr_topics=15  # ìë™ ëŒ€ì‹  ê³ ì •ê°’
)
```

### ìœ ì‚¬ë„ ê³„ì‚°ì´ ë„ˆë¬´ ëŠë¦´ ë•Œ
```python
# ë¬¸ì„œê°€ ë§ìœ¼ë©´ O(n^2) ë³µì¡ë„
# í•´ê²°: ìƒìœ„ Kê°œë§Œ ê³„ì‚°í•˜ë„ë¡ ìˆ˜ì •
# ë˜ëŠ” LSH (Locality Sensitive Hashing) ì‚¬ìš©
```

## ğŸ’¾ ë””ìŠ¤í¬ I/O ìµœì í™”

### SSD ì‚¬ìš©
- ëª¨ë¸ ìºì‹œë¥¼ SSDì— ì €ì¥
- ì„ë² ë”© ìºì‹œë¥¼ SSDì— ì €ì¥

### ìºì‹œ íŒŒì¼ ìœ„ì¹˜ ë³€ê²½
```python
# cache_manager.py
cache_manager = CacheManager(cache_dir="/path/to/ssd/cache")
```

## ğŸ¯ ê¶Œì¥ ì›Œí¬í”Œë¡œìš°

### ê°œë°œ ë‹¨ê³„
```bash
# ì‘ì€ ìƒ˜í”Œë¡œ ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸
python -X utf8 test/test_embedding_workflow.py --sample-size 10
```

### íŒŒë¼ë¯¸í„° íŠœë‹ ë‹¨ê³„
```bash
# ì¤‘ê°„ ìƒ˜í”Œ + ìºì‹œ ì‚¬ìš©
python -X utf8 test/test_embedding_workflow.py --use-cache --sample-size 50
```

### ìµœì¢… ì‹¤í–‰ ë‹¨ê³„
```bash
# ì „ì²´ ë°ì´í„° + ìºì‹œ ì‚¬ìš©
python -X utf8 test/test_embedding_workflow.py --use-cache --sample-size 376
```
